\documentclass[12pt,fleqn,twoside,a4paper]{book}

\usepackage[utf8]{inputenc} %% lettere accentate
\usepackage[italian]{babel}

\RequirePackage{pdf14}
\usepackage[a-1b]{pdfx}

\usepackage[toc,page]{appendix}
\usepackage[T1]{fontenc}
\usepackage[procnames]{listings}
\usepackage{quoting}
\usepackage{csquotes}
\usepackage{xcolor}
\usepackage{eurosym}
\usepackage{ragged2e}
\usepackage{fancyhdr}
\usepackage{caption}
\usepackage{subfiles}
\usepackage{graphicx}

%\usepackage{booktabs}
\graphicspath{{immagini}{../immagini/}}

\setlength{\headheight}{15pt}
\makeatletter
\renewcommand{\chaptermark}[1]{%
  \ifnum\value{chapter}>0
    \markboth{Capitolo \thechapter{}: #1}{}%
  \else
    \markboth{#1}{}%
  \fi}
\makeatother
\fancypagestyle{frontmatter}{%
  \fancyhf{}% Clear header/footer
  \fancyfoot[C]{\thepage}%
}



\fancypagestyle{mainmatter}{%
  \fancyhf{}% Clear header/footer
  \fancyhead[LE,RO]{\itshape \nouppercase \rightmark}
  \fancyhead[LO,RE]{\itshape \nouppercase Capitolo \arabic{chapter}}
  \fancyfoot[C]{\thepage}
}
\usepackage{afterpage}

\newcommand\blankpage{%
    \null
    \thispagestyle{empty}%
    \addtocounter{page}{-1}%
    \newpage}
%\fancyhead[LE,RO]{\itshape \nouppercase \rightmark}
%\fancyhead[LO,RE]{\itshape \nouppercase Capitolo \arabic{chapter}}

\quotingsetup{font=small}
\DeclareFixedFont{\ttb}{T1}{txtt}{bx}{n}{12} % for bold
\DeclareFixedFont{\ttm}{T1}{txtt}{m}{n}{12}  % for normal

\usepackage[top=2.5cm,margin=3cm,bottom=2.5cm]{geometry}
\usepackage{palatino}
\usepackage{enumitem}
\usepackage{float}
\usepackage{tabulary}
\usepackage{longtable}
\usepackage{tikz}
\usepackage{amsmath}
\usepackage{fancyvrb}
%\usepackage[compact]{titlesec}

\newtheorem{definition}{Definizione}[section]
\newcommand{\pij}[1]{\var{p}\ensuremath{_{#1}}}
\newcommand{\m}[1]{\var{m}\ensuremath{_{#1}}}
\newcommand{\ve}[1]{\var{v}\ensuremath{_{#1}}}
\newcommand{\ed}[1]{\var{e}\ensuremath{_{#1}}}
\newcommand{\e}[1]{\var{evid}\ensuremath{_{#1}}}
\newcommand{\cond}[1]{\var{cond}\ensuremath{_{#1}}}
\newcommand{\A}{{\it Attr\/}}
\newcommand{\M}{{\it M\/}}
\newcommand{\bi}{{\it b\/}}
\newcommand{\toc}{{\it ToC\/}}
\newcommand{\var}[1]{{\it #1\/}}
\newcommand{\Rec}[1]{\ensuremath{R_{#1}\/}}
\newcommand{\ER}[1]{\ensuremath{ER_{#1}\/}}
\newcommand{\EP}[1]{\ensuremath{EP_{#1}\/}}
\newcommand{\Eval}[1]{\ensuremath{Eval_{#1}\/}}



% ABILITA BIBLIO
\usepackage[backend=biber, style=numeric, sorting=none, maxbibnames=5]{biblatex}


\setcounter{biburllcpenalty}{7000}
\setcounter{biburlucpenalty}{8000}

\addbibresource{bibliografia.bib}
\input{linguaggi/python.tex}
\input{linguaggi/html.tex}
\input{linguaggi/xml.tex}
%\addto{\captionsenglish}{\renewcommand*{\appendixname}{Appendici}}

%%%%%%%%%%%%%
% tabelle lunghe
%%%%%%%%%%%%%

\makeatletter
\def\ltabulary{%
\def\endfirsthead{\\}%
\def\endhead{\\}%
\def\endfoot{\\}%
\def\endlastfoot{\\}%
\def\tabulary{%
  \def\TY@final{%
\def\endfirsthead{\LT@end@hd@ft\LT@firsthead}%
\def\endhead{\LT@end@hd@ft\LT@head}%
\def\endfoot{\LT@end@hd@ft\LT@foot}%
\def\endlastfoot{\LT@end@hd@ft\LT@lastfoot}%
\longtable}%
  \let\endTY@final\endlongtable
  \TY@tabular}%
\dimen@\columnwidth
\advance\dimen@-\LTleft
\advance\dimen@-\LTright
\tabulary\dimen@}
\def\endltabulary{\endtabulary}
\makeatother

%%%%%%%%%%%%%%%%%%%%%%%%%



\AtBeginDocument{\addtocontents{toc}{\protect\thispagestyle{plain}}} 
\AtBeginDocument{\addtocontents{lof}{\protect\thispagestyle{plain}}} 
\AtBeginDocument{\addtocontents{lot}{\protect\thispagestyle{plain}}}

\title{TESI}
\author{Patrizio Tufarolo}
\date{April 2017}
\frontmatter
\makeindex


\begin{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pagestyle{frontmatter}
\input{sezioni/frontespizio.tex}
\blankpage
\input{sezioni/dedica.tex}
\input{sezioni/prefazione.tex}
\blankpage
\input{sezioni/ringraziamenti.tex}
\input{sezioni/indice.tex}
%\input{sezioni/simboli_e_notazioni.tex}
\pagestyle{mainmatter}
\mainmatter
\input{sezioni/capitoli.tex}
\pagestyle{frontmatter}
\input{sezioni/appendice.tex}
% Abilita biblio
\input{sezioni/bibliografia.tex}
%\input{sezioni/indice_analitico.tex}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{document}
